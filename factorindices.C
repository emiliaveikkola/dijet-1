#include <iostream>
#include <vector>
#include <algorithm>

// Function to find the index of the closest value less than or equal to the target
int findIndex(const std::vector<double>& values, double target) {
    auto lower = std::lower_bound(values.begin(), values.end(), target);
    if (lower == values.end() || *lower != target) {
        if (lower == values.begin()) {
            return -1; // Target is smaller than the first element
        } else {
            --lower; // Find the closest lower value
        }
    }
    return lower - values.begin();
}

int factorindices() {
    // Known scale factors
    std::vector<double> scale_factors = {
        0.95, 0.9505, 0.951, 0.9515, 0.952, 0.9525, 0.953, 0.9535, 0.954, 0.9545, 0.955,
        0.9555, 0.956, 0.9565, 0.957, 0.9575, 0.958, 0.9585, 0.959, 0.9595, 0.96, 0.9605,
        0.961, 0.9615, 0.962, 0.9625, 0.963, 0.9635, 0.964, 0.9645, 0.965, 0.9655, 0.966,
        0.9665, 0.967, 0.9675, 0.968, 0.9685, 0.969, 0.9695, 0.97, 0.9705, 0.971, 0.9715,
        0.972, 0.9725, 0.973, 0.9735, 0.974, 0.9745, 0.975, 0.9755, 0.976, 0.9765, 0.977,
        0.9775, 0.978, 0.9785, 0.979, 0.9795, 0.98, 0.9805, 0.981, 0.9815, 0.982, 0.9825,
        0.983, 0.9835, 0.984, 0.9845, 0.985, 0.9855, 0.986, 0.9865, 0.987, 0.9875, 0.988,
        0.9885, 0.989, 0.9895, 0.99, 0.9905, 0.991, 0.9915, 0.992, 0.9925, 0.993, 0.9935,
        0.994, 0.9945, 0.995, 0.9955, 0.996, 0.9965, 0.997, 0.9975, 0.998, 0.9985, 0.999,
        0.9995, 1.0, 1.0005, 1.001, 1.0015, 1.002, 1.0025, 1.003, 1.0035, 1.004, 1.0045,
        1.005, 1.0055, 1.006, 1.0065, 1.007, 1.0075, 1.008, 1.0085, 1.009, 1.0095, 1.01,
        1.0105, 1.011, 1.0115, 1.012, 1.0125, 1.013, 1.0135, 1.014, 1.0145, 1.015, 1.0155,
        1.016, 1.0165, 1.017, 1.0175, 1.018, 1.0185, 1.019, 1.0195, 1.02, 1.0205, 1.021,
        1.0215, 1.022, 1.0225, 1.023, 1.0235, 1.024, 1.0245, 1.025, 1.0255, 1.026, 1.0265,
        1.027, 1.0275, 1.028, 1.0285, 1.029, 1.0295, 1.03, 1.0305, 1.031, 1.0315, 1.032,
        1.0325, 1.033, 1.0335, 1.034, 1.0345, 1.035, 1.0355, 1.036, 1.0365, 1.037, 1.0375,
        1.038, 1.0385, 1.039, 1.0395, 1.04, 1.0405, 1.041, 1.0415, 1.042, 1.0425, 1.043,
        1.0435, 1.044, 1.0445, 1.045, 1.0455, 1.046, 1.0465, 1.047, 1.0475, 1.048, 1.0485,
        1.049, 1.0495, 1.05
    };

    // Corresponding chi-squared errors
    std::vector<double> chi_squared_errors = {
        16180.7, 15112.3, 13886.2, 12981.7, 12162.6, 11470.1, 10706.3, 9909.81, 9135.9,
        8353.44, 7785, 7420.16, 7149.82, 6802.9, 6379.13, 6108.44, 5696.67, 5298.89, 5025.72,
        4673.56, 4435.17, 4124.12, 3847.14, 3636.72, 3397.77, 3242.11, 3154.59, 2960.13,
        2858.88, 2643.6, 2538.92, 2388.1, 2161.14, 2044.91, 1918.25, 1841.97, 1733.54,
        1618.62, 1497.61, 1389.46, 1325.34, 1263.6, 1180.55, 1122.12, 1061.5, 1002.99,
        957.224, 899.541, 849.752, 801.437, 749.339, 703.795, 647.029, 605.482, 566.821,
        533.322, 503.579, 476.514, 454.355, 429.982, 403.906, 379.12, 353.945, 331.64,
        310.129, 289.847, 269.814, 253.3, 239.386, 224.009, 209.289, 194.641, 182.697,
        172.895, 162.882, 152.501, 143.335, 132.874, 124.709, 117.374, 107.256, 98.385,
        94.8861, 87.9151, 84.3611, 78.8373, 72.3278, 65.6083, 61.3908, 57.7435, 55.4328,
        50.2954, 47.6088, 45.9186, 44.9888, 43.5044, 42.3435, 39.6665, 38.4312, 37.1658,
        37.6537, 36.9875, 35.8387, 36.4393, 37.4443, 35.5774, 36.5171, 37.4633, 38.3913,
        38.6454, 39.5356, 38.8629, 39.8902, 41.7556, 42.1698, 43.1117, 45.3747, 46.9766,
        43.3104, 44.556, 47.2335, 49.8783, 51.7407, 53.7798, 55.8591, 59.2785, 62.7574,
        66.3419, 69.1756, 74.5164, 79.0109, 81.511, 86.9393, 91.362, 94.9241, 99.5533,
        106.208, 113.818, 117.553, 123.271, 128.588, 137.025, 143.715, 151.695, 155.971,
        160.257, 170.024, 182.022, 191.884, 204.194, 212.165, 219.863, 228.126, 236.894,
        246.763, 257.249, 270.787, 281.958, 299.589, 311.792, 325.813, 344.384, 359.749,
        376.542, 394.285, 408.356, 428.374, 452.068, 477.442, 497.127, 518.395, 545.92,
        569.089, 597.009, 623.832, 736.125, 772.73, 821.503, 862.862, 905.164, 949.602,
        1000.85, 1046.88, 1110.73, 1153.06, 1213.69, 1276.7, 1337.58, 1407.75, 1515.28,
        1567.34, 1640.08, 1730.35, 1831.36, 1940.7, 2095.8, 2191.77, 2317.14, 2488.65,
        2663.56, 2821.38
        };
        // Find indices for specific scale factors
double target1 = 1.0025;
double target2 = 1.003;

int index1 = findIndex(scale_factors, target1);
int index2 = findIndex(scale_factors, target2);

// Retrieve and print corresponding chi-squared values
if (index1 != -1) {
    std::cout << "Index for scale factor " << target1 << " is " << index1 << ", Chi-Squared: " << chi_squared_errors[index1] << std::endl;
} else {
    std::cout << "Scale factor " << target1 << " not found in the list." << std::endl;
}

if (index2 != -1) {
    std::cout << "Index for scale factor " << target2 << " is " << index2 << ", Chi-Squared: " << chi_squared_errors[index2] << std::endl;
} else {
    std::cout << "Scale factor " << target2 << " not found in the list." << std::endl;
}

return 0;
}